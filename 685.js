"use strict";(self.webpackChunktest_frontend_spa=self.webpackChunktest_frontend_spa||[]).push([[685],{9685:(e,t,n)=>{n.r(t),n.d(t,{default:()=>L});var r=n(6540),o=n(9067),a=n(7286),i=n(3549),l=n(6990),c=n(6718),u=n(967);const s=function(e){var t=e.handleAddNewRow;return r.createElement(i.b,{sx:{justifyContent:"space-between"}},r.createElement(l.A,{color:"primary",startIcon:r.createElement(c.A,null),onClick:t},u.R_.addNewRecord))};var d=n(6035),f=n(2582),m=n(8087),p=n(4441),h=n(7331),b=n(8597),v=n(8228),w=n(8984),y=n(9781),g=n(767),S=function(){return S=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},S.apply(this,arguments)},k={field:"",editable:!0,renderEditCell:function(e){return r.createElement(g.B,S({},e,{title:e.error_message||""}))},preProcessEditCellProps:function(e){var t=null===e.props.value;return S(S({},e.props),{error:t,error_message:t?"Поле не должно быть пустым":""})}},E=[S(S({},k),{field:"employeeNumber",type:"number",headerName:u._5.employeeNumber,align:"left",minWidth:100,flex:1}),{editable:!0,field:"employeeSigDate",type:"dateTime",headerName:u._5.employeeSigDate,minWidth:100,flex:1,renderCell:function(e){var t,n;return r.createElement("div",{title:null===(t=e.value)||void 0===t?void 0:t.toLocaleString()},null===(n=e.value)||void 0===n?void 0:n.toLocaleDateString())},valueGetter:function(e){return new Date(e)}},S(S({},k),{field:"documentType",headerName:u._5.documentType,minWidth:150,flex:1}),S(S({},k),{field:"documentName",headerName:u._5.documentName,minWidth:150,flex:1}),S(S({},k),{field:"documentStatus",headerName:u._5.documentStatus,minWidth:100,flex:1}),{editable:!0,field:"companySigDate",type:"dateTime",headerName:u._5.companySigDate,minWidth:100,flex:1,renderCell:function(e){var t,n;return r.createElement("div",{title:null===(t=e.value)||void 0===t?void 0:t.toLocaleString()},null===(n=e.value)||void 0===n?void 0:n.toLocaleDateString())},valueGetter:function(e){return new Date(e)}},S(S({},k),{field:"employeeSignatureName",headerName:u._5.employeeSignatureName,minWidth:100,flex:1}),S(S({},k),{field:"companySignatureName",headerName:u._5.companySignatureName,minWidth:100,flex:1})],C=n(1712),N=n(3561),R=n(4213),x=n(9127),_=n(658),A=n(3023),M=function(){return M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},M.apply(this,arguments)},P=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}))},D=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},O=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},j=function(){return j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},j.apply(this,arguments)},W={width:"100%","& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary"}};j({minHeight:450},W);const L=function(e){var t=e.data,n=e.loading,i=function(e){var t=(0,r.useState)(e),n=t[0],o=t[1],a=(0,r.useState)({}),i=a[0],l=a[1],c=(0,r.useState)({}),u=c[0],s=c[1],g=(0,R.k)().showSnackbar,S=(0,x.jL)(),k=(0,r.useState)([]),j=k[0],W=k[1],L=(0,f.b)();(0,r.useEffect)((function(){return o(O(O([],e,!0),j,!0))}),[e]),(0,r.useEffect)((function(){setTimeout((function(){S((0,_.s)(!1))}))}),[e]);var T=(0,r.useCallback)((function(e){return function(){var t;l(M(M({},i),((t={})[e]={mode:m.V_.Edit},t)))}}),[i]),V=(0,r.useCallback)((function(e){return function(){var t;u[e]||l(M(M({},i),((t={})[e]={mode:m.V_.View},t)))}}),[i]),U=(0,r.useCallback)((function(e){return function(){return P(void 0,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return S((0,_.s)(!0)),t=S((0,d.aR)(e)),K(e,t.abort),[4,t.unwrap().catch((function(){S((0,_.s)(!1))}))];case 1:return n.sent(),J(e),[2]}}))}))}}),[S]),Z=(0,r.useCallback)((function(e){return function(){var t;u[e]||(l(M(M({},i),((t={})[e]={mode:m.V_.View,ignoreModifications:!0},t))),j.find((function(t){return t.id===e}))&&H(e))}}),[j,i]),q=(0,r.useCallback)((function(e,t){switch(t.defaultMuiPrevented=!0,e.reason){case p.q.escapeKeyDown:Z(e.id)();break;case p.q.enterKeyDown:V(e.id)()}}),[Z,V]),z=(0,r.useCallback)((function(e){return P(void 0,void 0,void 0,(function(){var t,n,r,o;return D(this,(function(a){switch(a.label){case 0:return t=e,n=e.id,r="",(0,C.fl)(e)?[2,Promise.reject("Заполните пустые поля")]:j.find((function(e){return e.id===n}))?(o=S((0,d.LB)({row:e})),K(n,o.abort),[4,o.unwrap().then((function(e){t=e,H(n)})).catch((function(e){return r=e}))]):[3,2];case 1:return a.sent(),J(n),[3,4];case 2:return o=S((0,d.LB)({row:e,id:n})),K(n,o.abort),[4,o.unwrap().then((function(e){t=e})).catch((function(e){return r=e}))];case 3:a.sent(),J(n),a.label=4;case 4:return r?[2,Promise.reject()]:[2,t]}}))}))}),[j,S]),B=(0,r.useCallback)((function(e){g(e)}),[]),F=(0,r.useCallback)((function(e){l(e)}),[]),G=(0,r.useCallback)((function(){var e=M(M({id:(0,N.Ak)()},C.ht),{companySigDate:(new Date).toISOString(),employeeSigDate:(new Date).toISOString()});I(e),l((function(t){var n;return M(M({},t),((n={})[e.id]={mode:m.V_.Edit,fieldToFocus:"employeeNumber"},n))})),L.current.setPage(0),L.current.sortColumn("companySigDate","desc")}),[L.current]),I=(0,r.useCallback)((function(e){W((function(t){return O(O([],t,!0),[e],!1)})),o((function(t){return O(O([],t,!0),[e],!1)}))}),[]),H=(0,r.useCallback)((function(e){W((function(t){return t.filter((function(t){return t.id!==e}))})),o((function(t){return t.filter((function(t){return t.id!==e}))}))}),[]),K=(0,r.useCallback)((function(e,t){s((function(n){var r;return M(M({},n),((r={})[e]=t,r))}))}),[]),J=(0,r.useCallback)((function(e){s((function(t){var n;return M(M({},t),((n={})[e]=void 0,n))}))}),[]),Q=(0,r.useMemo)((function(){return O(O([],E,!0),[{field:"actions",type:"actions",headerName:"Actions",minWidth:126,cellClassName:"actions",getActions:function(e){var t,n=e.id,o=(null===(t=i[n])||void 0===t?void 0:t.mode)===m.V_.Edit,a=!!u[n],l=a?[r.createElement(h.Z,{icon:r.createElement(A.A,{color:"warning"}),label:"Abort",title:"Отменить запрос",sx:{animation:"spin 2s linear infinite","@keyframes spin":{"0%":{transform:"rotate(360deg)"},"100%":{transform:"rotate(0deg)"}}},onClick:u[n]})]:[],c=[r.createElement(h.Z,{icon:r.createElement(w.A,null),label:"Save",sx:{color:"primary.main"},onClick:V(n),disabled:a}),r.createElement(h.Z,{icon:r.createElement(y.A,null),label:"Cancel",className:"textPrimary",onClick:Z(n),color:"inherit",disabled:a})],s=[r.createElement(h.Z,{icon:r.createElement(b.A,null),label:"Edit",className:"textPrimary",onClick:T(n),color:"inherit",disabled:a}),r.createElement(h.Z,{icon:r.createElement(v.A,null),label:"Delete",onClick:U(n),color:"inherit",disabled:a})];return O(O([],o?c:s,!0),l,!0)}}],!1)}),[i,u,V,Z,T,U]);return{rows:n,rowModesModel:i,columns:Q,handlers:{handleRowEditStop:q,processRowUpdate:z,handleRowModesModelChange:F,handleAddNewRow:G,onProcessRowUpdateError:B,abortFetch:u},apiRef:L,activeRequests:Object.keys(u).length>0}}(t),l=i.rows,c=i.rowModesModel,u=i.columns,g=i.handlers,S=i.apiRef,k=i.activeRequests,L=g.handleAddNewRow,T=g.handleRowEditStop,V=g.handleRowModesModelChange,U=g.processRowUpdate,Z=g.onProcessRowUpdateError,q=g.abortFetch;return r.useMemo((function(){return r.createElement(o.A,{sx:j({height:"65vh"},W)},r.createElement(a.z,{rows:l,columns:u,editMode:"row",rowModesModel:c,onRowModesModelChange:V,onRowEditStop:T,processRowUpdate:U,onProcessRowUpdateError:Z,slots:{toolbar:s},slotProps:{toolbar:{handleAddNewRow:L}},initialState:{pagination:void 0,sorting:{sortModel:[{field:"employeeSigDate",sort:"desc"}]}},sx:{minHeight:"auto",p:1},apiRef:S,loading:n&&!k,pageSizeOptions:[5,10,25,50,100],autoPageSize:!0}))}),[t,n,l,c,u,S,L,T,V,U,Z,q,k])}}}]);
//# sourceMappingURL=685.js.map