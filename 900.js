"use strict";(self.webpackChunktest_frontend_spa=self.webpackChunktest_frontend_spa||[]).push([[900],{6900:(e,t,n)=>{n.r(t),n.d(t,{default:()=>B});var r=n(6540),o=n(9067),a=n(9588),i=n(3549),l=n(6990),c=n(6718),u=n(967);const s=function(e){var t=e.handleAddNewRow;return r.createElement(i.b,{sx:{justifyContent:"space-between"}},r.createElement(l.A,{color:"primary",startIcon:r.createElement(c.A,null),onClick:t},u.R_.addNewRecord))};var d=n(6035),f=n(2582),m=n(8087),p=n(4441),h=n(7331),b=n(8597),v=n(8228),y=n(8984),w=n(9781),g=n(767),C=function(){return C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},C.apply(this,arguments)},E={field:"",editable:!0,minWidth:100,renderEditCell:function(e){return r.createElement(g.B,C({},e,{title:e.error_message||""}))},preProcessEditCellProps:function(e){var t=null===e.props.value;return C(C({},e.props),{error:t,error_message:t?"Поле не должно быть пустым":""})}},k=[C(C({},E),{field:"employeeNumber",type:"number",headerName:u._5.employeeNumber,align:"left",minWidth:60,flex:1}),{editable:!0,field:"employeeSigDate",type:"dateTime",minWidth:100,headerName:u._5.employeeSigDate,flex:1,renderCell:function(e){var t,n;return r.createElement("div",{title:null===(t=e.value)||void 0===t?void 0:t.toLocaleString()},null===(n=e.value)||void 0===n?void 0:n.toLocaleDateString())},valueGetter:function(e){return new Date(e)}},C(C({},E),{field:"documentType",headerName:u._5.documentType,flex:1}),C(C({},E),{field:"documentName",headerName:u._5.documentName,flex:1}),C(C({},E),{field:"documentStatus",headerName:u._5.documentStatus,flex:1}),{editable:!0,field:"companySigDate",type:"dateTime",minWidth:100,headerName:u._5.companySigDate,flex:1,renderCell:function(e){var t,n;return r.createElement("div",{title:null===(t=e.value)||void 0===t?void 0:t.toLocaleString()},null===(n=e.value)||void 0===n?void 0:n.toLocaleDateString())},valueGetter:function(e){return new Date(e)}},C(C({},E),{field:"employeeSignatureName",headerName:u._5.employeeSignatureName,flex:1}),C(C({},E),{field:"companySignatureName",headerName:u._5.companySignatureName,flex:1})],S=n(1712),A=n(3561),N=n(4213),R=n(9127),x=n(658),_=n(3023),O=function(){return O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},O.apply(this,arguments)},P=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}))},M=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},D=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},j=n(7414),L=n(4389),T=n(8031),V=n(6831),U=n(2477),Z=n(7867),W=n(8763);const q=function(e){var t,n=e.title,o=e.body,a=e.open,i=e.onClose,c=e.onConfirm,s=(0,r.useState)(!1),d=s[0],f=s[1];return r.createElement(T.A,{open:a,onClose:i,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.createElement(V.A,{id:"alert-dialog-title"},n),r.createElement(U.A,null,r.createElement(Z.A,{id:"alert-dialog-description"},o)),r.createElement(W.A,null,r.createElement(j.A,{control:r.createElement(L.A,{checked:d,onChange:function(){return f(!d)}}),label:u.R_.askConfirm,labelPlacement:"end"})),r.createElement(W.A,null,r.createElement(l.A,{onClick:(t=!d,function(){c(t)})},"Удалить"),r.createElement(l.A,{onClick:i,autoFocus:!0},"Отмена")))};var F=function(){return F=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},F.apply(this,arguments)},z={width:"100%","& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary"}};F({minHeight:450},z);const B=function(e){var t=e.data,n=e.loading,i=function(e){var t=(0,r.useState)(e),n=t[0],o=t[1],a=(0,r.useState)({}),i=a[0],l=a[1],c=(0,r.useState)({}),u=c[0],s=c[1],g=(0,N.k)().showSnackbar,C=(0,R.jL)(),E=function(){var e=(0,r.useState)(!0),t=e[0],n=e[1],o=(0,r.useState)(),a=o[0],i=o[1],l=(0,r.useCallback)((function(){i(void 0)}),[]),c=(0,r.useCallback)((function(){return function(e){n(e),a&&(a(),i(void 0))}}),[a]);return{askConfirm:t,confirmOpen:a,onClose:l,onConfirm:c,setConfirmOpen:i}}(),j=E.askConfirm,L=E.confirmOpen,T=E.onClose,V=E.onConfirm,U=E.setConfirmOpen,Z=(0,r.useState)([]),W=Z[0],q=Z[1],F=(0,f.b)();(0,r.useEffect)((function(){return o(D(D([],e,!0),W,!0))}),[e]),(0,r.useEffect)((function(){setTimeout((function(){C((0,x.s)(!1))}))}),[e]);var z=(0,r.useCallback)((function(e){return function(){var t;l(O(O({},i),((t={})[e]={mode:m.V_.Edit},t)))}}),[i]),B=(0,r.useCallback)((function(e){return function(){var t;u[e]||l(O(O({},i),((t={})[e]={mode:m.V_.View},t)))}}),[i]),G=(0,r.useCallback)((function(e){j?U((function(){return e})):e()}),[j]),I=(0,r.useCallback)((function(e){return function(){G((function(){return P(void 0,void 0,void 0,(function(){var t;return M(this,(function(n){switch(n.label){case 0:return C((0,x.s)(!0)),t=C((0,d.aR)(e)),te(e,t.abort),[4,t.unwrap().catch((function(){C((0,x.s)(!1))}))];case 1:return n.sent(),ne(e),[2]}}))}))}))}}),[C,G]),H=(0,r.useCallback)((function(e){return function(){var t;u[e]||(l(O(O({},i),((t={})[e]={mode:m.V_.View,ignoreModifications:!0},t))),W.find((function(t){return t.id===e}))&&ee(e))}}),[W,i]),K=(0,r.useCallback)((function(e,t){switch(t.defaultMuiPrevented=!0,e.reason){case p.q.escapeKeyDown:H(e.id)();break;case p.q.enterKeyDown:B(e.id)()}}),[H,B]),J=(0,r.useCallback)((function(e){return P(void 0,void 0,void 0,(function(){var t,n,r,o;return M(this,(function(a){switch(a.label){case 0:return t=e,n=e.id,r="",(0,S.fl)(e)?[2,Promise.reject("Заполните пустые поля")]:W.find((function(e){return e.id===n}))?(o=C((0,d.LB)({row:e})),te(n,o.abort),[4,o.unwrap().then((function(e){t=e,ee(n)})).catch((function(e){return r=e}))]):[3,2];case 1:return a.sent(),ne(n),[3,4];case 2:return o=C((0,d.LB)({row:e,id:n})),te(n,o.abort),[4,o.unwrap().then((function(e){t=e})).catch((function(e){return r=e}))];case 3:a.sent(),ne(n),a.label=4;case 4:return r?[2,Promise.reject()]:[2,t]}}))}))}),[W,C]),Q=(0,r.useCallback)((function(e){g(e)}),[]),X=(0,r.useCallback)((function(e){l(e)}),[]),Y=(0,r.useCallback)((function(){var e=O(O({id:(0,A.Ak)()},S.ht),{companySigDate:(new Date).toISOString(),employeeSigDate:(new Date).toISOString()});$(e),l((function(t){var n;return O(O({},t),((n={})[e.id]={mode:m.V_.Edit,fieldToFocus:"employeeNumber"},n))})),F.current.setPage(0),F.current.sortColumn("companySigDate","desc")}),[F.current]),$=(0,r.useCallback)((function(e){q((function(t){return D(D([],t,!0),[e],!1)})),o((function(t){return D(D([],t,!0),[e],!1)}))}),[]),ee=(0,r.useCallback)((function(e){q((function(t){return t.filter((function(t){return t.id!==e}))})),o((function(t){return t.filter((function(t){return t.id!==e}))}))}),[]),te=(0,r.useCallback)((function(e,t){s((function(n){var r;return O(O({},n),((r={})[e]=t,r))}))}),[]),ne=(0,r.useCallback)((function(e){s((function(t){var n;return O(O({},t),((n={})[e]=void 0,n))}))}),[]),re=(0,r.useMemo)((function(){return D(D([],k,!0),[{field:"actions",type:"actions",headerName:"Actions",minWidth:126,cellClassName:"actions",getActions:function(e){var t,n=e.id,o=(null===(t=i[n])||void 0===t?void 0:t.mode)===m.V_.Edit,a=!!u[n],l=a?[r.createElement(h.Z,{icon:r.createElement(_.A,{color:"warning"}),label:"Abort",title:"Отменить запрос",sx:{animation:"spin 2s linear infinite","@keyframes spin":{"0%":{transform:"rotate(360deg)"},"100%":{transform:"rotate(0deg)"}}},onClick:u[n]})]:[r.createElement(h.Z,{icon:r.createElement(_.A,{color:"inherit"}),label:"Abort",title:"Отменить запрос"})],c=[r.createElement(h.Z,{icon:r.createElement(y.A,null),label:"Save",sx:{color:"primary.main"},onClick:B(n),disabled:a}),r.createElement(h.Z,{icon:r.createElement(w.A,null),label:"Cancel",className:"textPrimary",onClick:H(n),color:"inherit",disabled:a})],s=[r.createElement(h.Z,{icon:r.createElement(b.A,null),label:"Edit",className:"textPrimary",onClick:z(n),color:"inherit",disabled:a}),r.createElement(h.Z,{icon:r.createElement(v.A,null),label:"Delete",onClick:I(n),color:"inherit",disabled:a})];return D(D([],o?c:s,!0),l,!0)}}],!1)}),[i,u,B,H,z,I]);return{rows:n,rowModesModel:i,columns:re,handlers:{handleRowEditStop:K,processRowUpdate:J,handleRowModesModelChange:X,handleAddNewRow:Y,onProcessRowUpdateError:Q,abortFetch:u,onClose:T,onConfirm:V},apiRef:F,activeRequests:Object.keys(u).length>0,confirmOpen:!!L}}(t),l=i.rows,c=i.rowModesModel,u=i.columns,g=i.handlers,C=i.apiRef,E=i.activeRequests,j=i.confirmOpen,L=g.handleAddNewRow,T=g.handleRowEditStop,V=g.handleRowModesModelChange,U=g.processRowUpdate,Z=g.onProcessRowUpdateError,W=g.onClose,B=g.onConfirm,G=g.abortFetch;return r.useMemo((function(){return r.createElement(o.A,{sx:F({height:"65vh"},z)},r.createElement(a.z,{rows:l,columns:u,editMode:"row",rowModesModel:c,onRowModesModelChange:V,onRowEditStop:T,processRowUpdate:U,onProcessRowUpdateError:Z,slots:{toolbar:s},slotProps:{toolbar:{handleAddNewRow:L}},initialState:{pagination:void 0,sorting:{sortModel:[{field:"employeeSigDate",sort:"desc"}]}},sx:{minHeight:"auto",p:1},apiRef:C,loading:n&&!E,pageSizeOptions:[5,10,25,50,100],autoPageSize:!0}),r.createElement(q,{title:"Подтвердите удаление",body:"",open:j,onClose:W,onConfirm:B()}))}),[t,n,l,c,u,C,L,T,V,U,Z,G,E,W,B,j])}}}]);
//# sourceMappingURL=900.js.map