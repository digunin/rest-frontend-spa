"use strict";(self.webpackChunktest_frontend_spa=self.webpackChunktest_frontend_spa||[]).push([[382],{2382:(e,n,t)=>{t.r(n),t.d(n,{default:()=>U});var r=t(6540),o=t(9067),a=t(520),i=t(3549),l=t(6990),c=t(6718),u=t(967);const s=function(e){var n=e.handleAddNewRow;return r.createElement(i.b,{sx:{justifyContent:"space-between"}},r.createElement(l.A,{color:"primary",startIcon:r.createElement(c.A,null),onClick:n},u.R_.addNewRecord))};var d=t(2582),f=t(8087),m=t(4441),p=t(7331),h=t(8597),y=t(8228),b=t(8984),v=t(9781),g=t(767),w=function(){return w=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},w.apply(this,arguments)},C={field:"",editable:!0,minWidth:100,renderEditCell:function(e){return r.createElement(g.B,w({},e,{title:e.error_message||""}))},preProcessEditCellProps:function(e){var n=null===e.props.value;return w(w({},e.props),{error:n,error_message:n?"Поле не должно быть пустым":""})}},S=[w(w({},C),{field:"employeeNumber",type:"number",headerName:u._5.employeeNumber,align:"left",minWidth:60,flex:1}),{editable:!0,field:"employeeSigDate",type:"dateTime",minWidth:100,headerName:u._5.employeeSigDate,flex:1,renderCell:function(e){var n,t;return r.createElement("div",{title:null===(n=e.value)||void 0===n?void 0:n.toLocaleString()},null===(t=e.value)||void 0===t?void 0:t.toLocaleDateString())},valueGetter:function(e){return new Date(e)}},w(w({},C),{field:"documentType",headerName:u._5.documentType,flex:1}),w(w({},C),{field:"documentName",headerName:u._5.documentName,flex:1}),w(w({},C),{field:"documentStatus",headerName:u._5.documentStatus,flex:1}),{editable:!0,field:"companySigDate",type:"dateTime",minWidth:100,headerName:u._5.companySigDate,flex:1,renderCell:function(e){var n,t;return r.createElement("div",{title:null===(n=e.value)||void 0===n?void 0:n.toLocaleString()},null===(t=e.value)||void 0===t?void 0:t.toLocaleDateString())},valueGetter:function(e){return new Date(e)}},w(w({},C),{field:"employeeSignatureName",headerName:u._5.employeeSignatureName,flex:1}),w(w({},C),{field:"companySignatureName",headerName:u._5.companySignatureName,flex:1})],k={companySigDate:"",companySignatureName:"",documentName:"",documentStatus:"",documentType:"",employeeNumber:"",employeeSigDate:"",employeeSignatureName:""},E=t(3561),N=t(4213),x=t(9127),R=t(3023),A=t(9789),_=t(3496),D=function(){return D=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},D.apply(this,arguments)},M=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,l)}c((r=r.apply(e,n||[])).next())}))},O=function(e,n){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(t=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],r=0}finally{t=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},P=function(e,n,t){if(t||2===arguments.length)for(var r,o=0,a=n.length;o<a;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))},j=t(9934),V=function(){return V=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},V.apply(this,arguments)},T=function(e,n,t){if(t||2===arguments.length)for(var r,o=0,a=n.length;o<a;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))},L={width:"100%","& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary"}};V({minHeight:450},L);const U=function(e){var n=e.data,t=e.loading,i=function(){var e=(0,r.useState)({}),n=e[0],t=e[1],o=(0,r.useState)([]),a=o[0],i=o[1],l=(0,N.k)().showSnackbar,c=(0,x.jL)(),u=(0,A.G)(),s=u.askConfirm,g=u.confirmOpen,w=u.onClose,C=u.onConfirm,j=u.setConfirmOpen,V=(0,r.useState)([]),T=V[0],L=V[1],U=(0,d.b)(),Z=(0,_.Lc)()[0],W=(0,_.cX)()[0],q=(0,_.eV)()[0],G=(0,r.useCallback)((function(e){return function(){var r;t(D(D({},n),((r={})[e]={mode:f.V_.Edit},r)))}}),[n]),z=(0,r.useCallback)((function(e){return function(){var r;a.includes(e)||t(D(D({},n),((r={})[e]={mode:f.V_.View},r)))}}),[n]),H=(0,r.useCallback)((function(e){s?j((function(){return e})):e()}),[s]),I=(0,r.useCallback)((function(e){return function(){H((function(){return M(void 0,void 0,void 0,(function(){var n;return O(this,(function(t){switch(t.label){case 0:return n=q(e),ee(e),[4,n.unwrap().catch((function(e){e.name}))];case 1:return t.sent(),ne(e),[2]}}))}))}))}}),[c,H]),K=(0,r.useCallback)((function(e){return function(){var r;a.includes(e)||(t(D(D({},n),((r={})[e]={mode:f.V_.View,ignoreModifications:!0},r))),T.find((function(n){return n.id===e}))&&$(e))}}),[T,n]),B=(0,r.useCallback)((function(e,n){switch(n.defaultMuiPrevented=!0,e.reason){case m.q.escapeKeyDown:K(e.id)();break;case m.q.enterKeyDown:z(e.id)()}}),[K,z]),F=(0,r.useCallback)((function(e){return M(void 0,void 0,void 0,(function(){var n,t,r,o;return O(this,(function(a){switch(a.label){case 0:return n=e,t=e.id,r={name:"",message:""},function(e){for(var n=0,t=Object.keys(e).filter((function(e){return"id"!==e}));n<t.length;n++)if(!e[t[n]])return!0;return!1}(e)?[2,Promise.reject("Заполните пустые поля")]:T.find((function(e){return e.id===t}))?(o=Z(e),ee(t),[4,o.unwrap().then((function(e){n=e,$(t)})).catch((function(e){return r=e}))]):[3,2];case 1:return a.sent(),ne(t),[3,4];case 2:return o=W(D(D({},e),{id:t})),ee(t),[4,o.unwrap().then((function(e){n=e})).catch((function(e){return r=e}))];case 3:a.sent(),ne(t),a.label=4;case 4:return r.message?[2,Promise.reject()]:[2,n]}}))}))}),[T,c]),X=(0,r.useCallback)((function(e){l(e)}),[]),J=(0,r.useCallback)((function(e){t(e)}),[]),Q=(0,r.useCallback)((function(){var e=D(D({id:(0,E.Ak)()},k),{companySigDate:(new Date).toISOString(),employeeSigDate:(new Date).toISOString()});Y(e),t((function(n){var t;return D(D({},n),((t={})[e.id]={mode:f.V_.Edit,fieldToFocus:"employeeNumber"},t))})),U.current.setPage(0),U.current.sortColumn("companySigDate","desc")}),[U.current]),Y=(0,r.useCallback)((function(e){L((function(n){return P(P([],n,!0),[e],!1)}))}),[]),$=(0,r.useCallback)((function(e){L((function(n){return n.filter((function(n){return n.id!==e}))}))}),[]),ee=(0,r.useCallback)((function(e){i((function(n){return P(P([],n,!0),[e],!1)}))}),[]),ne=(0,r.useCallback)((function(e){i((function(n){return n.filter((function(n){return n!==e}))}))}),[]),te=(0,r.useMemo)((function(){return P(P([],S,!0),[{field:"actions",type:"actions",headerName:"Actions",minWidth:126,cellClassName:"actions",getActions:function(e){var t,o=e.id,i=(null===(t=n[o])||void 0===t?void 0:t.mode)===f.V_.Edit,l=a.includes(o),c=l?[r.createElement(p.Z,{icon:r.createElement(R.A,{color:"warning"}),label:"indicator",disabled:!0,sx:{animation:"spin 2s linear infinite","@keyframes spin":{"0%":{transform:"rotate(360deg)"},"100%":{transform:"rotate(0deg)"}}}})]:[r.createElement(p.Z,{icon:r.createElement(R.A,{color:"inherit"}),label:"indicator",disabled:!0})],u=[r.createElement(p.Z,{icon:r.createElement(b.A,null),label:"Save",sx:{color:"primary.main"},onClick:z(o),disabled:l}),r.createElement(p.Z,{icon:r.createElement(v.A,null),label:"Cancel",className:"textPrimary",onClick:K(o),color:"inherit",disabled:l})],s=[r.createElement(p.Z,{icon:r.createElement(h.A,null),label:"Edit",className:"textPrimary",onClick:G(o),color:"inherit",disabled:l}),r.createElement(p.Z,{icon:r.createElement(y.A,null),label:"Delete",onClick:I(o),color:"inherit",disabled:l})];return P(P([],i?u:s,!0),c,!0)}}],!1)}),[a,n,z,K,G,I]);return{rows:T,rowModesModel:n,columns:te,handlers:{handleRowEditStop:B,processRowUpdate:F,handleRowModesModelChange:J,handleAddNewRow:Q,onProcessRowUpdateError:X,onClose:w,onConfirm:C},apiRef:U,activeRequests:a.length>0,confirmOpen:!!g}}(),l=i.rows,c=i.rowModesModel,u=i.columns,g=i.handlers,w=i.apiRef,C=i.activeRequests,V=i.confirmOpen,U=g.handleAddNewRow,Z=g.handleRowEditStop,W=g.handleRowModesModelChange,q=g.processRowUpdate,G=g.onProcessRowUpdateError,z=g.onClose,H=g.onConfirm;return r.useMemo((function(){return r.createElement(o.A,{sx:L},r.createElement(a.z,{rows:T(T([],n,!0),l,!0),columns:u,editMode:"row",rowModesModel:c,onRowModesModelChange:W,onRowEditStop:Z,processRowUpdate:q,onProcessRowUpdateError:G,slots:{toolbar:s},slotProps:{toolbar:{handleAddNewRow:U}},initialState:{pagination:{paginationModel:{pageSize:5}},sorting:{sortModel:[{field:"employeeSigDate",sort:"desc"}]}},sx:{minHeight:450,p:1},apiRef:w,loading:t&&!C,pageSizeOptions:[5,10,25,50,100],autoHeight:!0}),r.createElement(j.A,{title:"Подтвердите удаление",body:"",open:V,onClose:z,onConfirm:H()}))}),[n,t,l,c,u,w,U,Z,W,q,G,C,z,H,V])}}}]);
//# sourceMappingURL=382.js.map