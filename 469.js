"use strict";(self.webpackChunktest_frontend_spa=self.webpackChunktest_frontend_spa||[]).push([[469],{5469:(e,n,t)=>{t.r(n),t.d(n,{default:()=>H});var r=t(6540),o=t(9067),a=t(9588),i=t(3549),l=t(6990),c=t(6718),u=t(967);const s=function(e){var n=e.handleAddNewRow;return r.createElement(i.b,{sx:{justifyContent:"space-between"}},r.createElement(l.A,{color:"primary",startIcon:r.createElement(c.A,null),onClick:n},u.R_.addNewRecord))};var d=t(2582),f=t(8087),m=t(4441),p=t(7331),h=t(8597),b=t(8228),y=t(8984),v=t(9781),g=t(767),w=function(){return w=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},w.apply(this,arguments)},C={field:"",editable:!0,minWidth:100,renderEditCell:function(e){return r.createElement(g.B,w({},e,{title:e.error_message||""}))},preProcessEditCellProps:function(e){var n=null===e.props.value;return w(w({},e.props),{error:n,error_message:n?"Поле не должно быть пустым":""})}},E=[w(w({},C),{field:"employeeNumber",type:"number",headerName:u._5.employeeNumber,align:"left",minWidth:60,flex:1}),{editable:!0,field:"employeeSigDate",type:"dateTime",minWidth:100,headerName:u._5.employeeSigDate,flex:1,renderCell:function(e){var n,t;return r.createElement("div",{title:null===(n=e.value)||void 0===n?void 0:n.toLocaleString()},null===(t=e.value)||void 0===t?void 0:t.toLocaleDateString())},valueGetter:function(e){return new Date(e)}},w(w({},C),{field:"documentType",headerName:u._5.documentType,flex:1}),w(w({},C),{field:"documentName",headerName:u._5.documentName,flex:1}),w(w({},C),{field:"documentStatus",headerName:u._5.documentStatus,flex:1}),{editable:!0,field:"companySigDate",type:"dateTime",minWidth:100,headerName:u._5.companySigDate,flex:1,renderCell:function(e){var n,t;return r.createElement("div",{title:null===(n=e.value)||void 0===n?void 0:n.toLocaleString()},null===(t=e.value)||void 0===t?void 0:t.toLocaleDateString())},valueGetter:function(e){return new Date(e)}},w(w({},C),{field:"employeeSignatureName",headerName:u._5.employeeSignatureName,flex:1}),w(w({},C),{field:"companySignatureName",headerName:u._5.companySignatureName,flex:1})],S={companySigDate:"",companySignatureName:"",documentName:"",documentStatus:"",documentType:"",employeeNumber:"",employeeSigDate:"",employeeSignatureName:""},k=t(3561),A=t(4213),N=t(9220),R=t(3023),x=t(3496),_=function(){return _=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},_.apply(this,arguments)},D=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,l)}c((r=r.apply(e,n||[])).next())}))},M=function(e,n){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(t=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],r=0}finally{t=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},O=function(e,n,t){if(t||2===arguments.length)for(var r,o=0,a=n.length;o<a;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))},P=t(7414),j=t(4389),V=t(8031),T=t(6831),L=t(2477),U=t(7867),Z=t(8763);const W=function(e){var n,t=e.title,o=e.body,a=e.open,i=e.onClose,c=e.onConfirm,s=(0,r.useState)(!1),d=s[0],f=s[1];return r.createElement(V.A,{open:a,onClose:i,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.createElement(T.A,{id:"alert-dialog-title"},t),r.createElement(L.A,null,r.createElement(U.A,{id:"alert-dialog-description"},o)),r.createElement(Z.A,null,r.createElement(P.A,{control:r.createElement(j.A,{checked:d,onChange:function(){return f(!d)}}),label:u.R_.askConfirm,labelPlacement:"end"})),r.createElement(Z.A,null,r.createElement(l.A,{onClick:(n=!d,function(){c(n)})},"Удалить"),r.createElement(l.A,{onClick:i,autoFocus:!0},"Отмена")))};var q=function(){return q=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},q.apply(this,arguments)},z=function(e,n,t){if(t||2===arguments.length)for(var r,o=0,a=n.length;o<a;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))},G={width:"100%","& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary"}};q({minHeight:450},G);const H=function(e){var n=e.data,t=e.loading,i=function(){var e=(0,r.useState)({}),n=e[0],t=e[1],o=(0,r.useState)([]),a=o[0],i=o[1],l=(0,A.k)().showSnackbar,c=(0,N.jL)(),u=function(){var e=(0,r.useState)(!0),n=e[0],t=e[1],o=(0,r.useState)(),a=o[0],i=o[1],l=(0,r.useCallback)((function(){i(void 0)}),[]),c=(0,r.useCallback)((function(){return function(e){t(e),a&&(a(),i(void 0))}}),[a]);return{askConfirm:n,confirmOpen:a,onClose:l,onConfirm:c,setConfirmOpen:i}}(),s=u.askConfirm,g=u.confirmOpen,w=u.onClose,C=u.onConfirm,P=u.setConfirmOpen,j=(0,r.useState)([]),V=j[0],T=j[1],L=(0,d.b)(),U=(0,x.Lc)()[0],Z=(0,x.cX)()[0],W=(0,x.eV)()[0],q=(0,r.useCallback)((function(e){return function(){var r;t(_(_({},n),((r={})[e]={mode:f.V_.Edit},r)))}}),[n]),z=(0,r.useCallback)((function(e){return function(){var r;a.includes(e)||t(_(_({},n),((r={})[e]={mode:f.V_.View},r)))}}),[n]),G=(0,r.useCallback)((function(e){s?P((function(){return e})):e()}),[s]),H=(0,r.useCallback)((function(e){return function(){G((function(){return D(void 0,void 0,void 0,(function(){var n;return M(this,(function(t){switch(t.label){case 0:return n=W(e),$(e),[4,n.unwrap().catch((function(e){e.name}))];case 1:return t.sent(),ee(e),[2]}}))}))}))}}),[c,G]),I=(0,r.useCallback)((function(e){return function(){var r;a.includes(e)||(t(_(_({},n),((r={})[e]={mode:f.V_.View,ignoreModifications:!0},r))),V.find((function(n){return n.id===e}))&&Y(e))}}),[V,n]),F=(0,r.useCallback)((function(e,n){switch(n.defaultMuiPrevented=!0,e.reason){case m.q.escapeKeyDown:I(e.id)();break;case m.q.enterKeyDown:z(e.id)()}}),[I,z]),K=(0,r.useCallback)((function(e){return D(void 0,void 0,void 0,(function(){var n,t,r,o;return M(this,(function(a){switch(a.label){case 0:return n=e,t=e.id,r={name:"",message:""},function(e){for(var n=0,t=Object.keys(e).filter((function(e){return"id"!==e}));n<t.length;n++)if(!e[t[n]])return!0;return!1}(e)?[2,Promise.reject("Заполните пустые поля")]:V.find((function(e){return e.id===t}))?(o=U(e),$(t),[4,o.unwrap().then((function(e){n=e,Y(t)})).catch((function(e){return r=e}))]):[3,2];case 1:return a.sent(),ee(t),[3,4];case 2:return o=Z(_(_({},e),{id:t})),$(t),[4,o.unwrap().then((function(e){n=e})).catch((function(e){return r=e}))];case 3:a.sent(),ee(t),a.label=4;case 4:return r.message?[2,Promise.reject()]:[2,n]}}))}))}),[V,c]),B=(0,r.useCallback)((function(e){l(e)}),[]),X=(0,r.useCallback)((function(e){t(e)}),[]),J=(0,r.useCallback)((function(){var e=_(_({id:(0,k.Ak)()},S),{companySigDate:(new Date).toISOString(),employeeSigDate:(new Date).toISOString()});Q(e),t((function(n){var t;return _(_({},n),((t={})[e.id]={mode:f.V_.Edit,fieldToFocus:"employeeNumber"},t))})),L.current.setPage(0),L.current.sortColumn("companySigDate","desc")}),[L.current]),Q=(0,r.useCallback)((function(e){T((function(n){return O(O([],n,!0),[e],!1)}))}),[]),Y=(0,r.useCallback)((function(e){T((function(n){return n.filter((function(n){return n.id!==e}))}))}),[]),$=(0,r.useCallback)((function(e){i((function(n){return O(O([],n,!0),[e],!1)}))}),[]),ee=(0,r.useCallback)((function(e){i((function(n){return n.filter((function(n){return n!==e}))}))}),[]),ne=(0,r.useMemo)((function(){return O(O([],E,!0),[{field:"actions",type:"actions",headerName:"Actions",minWidth:126,cellClassName:"actions",getActions:function(e){var t,o=e.id,i=(null===(t=n[o])||void 0===t?void 0:t.mode)===f.V_.Edit,l=a.includes(o),c=l?[r.createElement(p.Z,{icon:r.createElement(R.A,{color:"warning"}),label:"indicator",disabled:!0,sx:{animation:"spin 2s linear infinite","@keyframes spin":{"0%":{transform:"rotate(360deg)"},"100%":{transform:"rotate(0deg)"}}}})]:[r.createElement(p.Z,{icon:r.createElement(R.A,{color:"inherit"}),label:"indicator",disabled:!0})],u=[r.createElement(p.Z,{icon:r.createElement(y.A,null),label:"Save",sx:{color:"primary.main"},onClick:z(o),disabled:l}),r.createElement(p.Z,{icon:r.createElement(v.A,null),label:"Cancel",className:"textPrimary",onClick:I(o),color:"inherit",disabled:l})],s=[r.createElement(p.Z,{icon:r.createElement(h.A,null),label:"Edit",className:"textPrimary",onClick:q(o),color:"inherit",disabled:l}),r.createElement(p.Z,{icon:r.createElement(b.A,null),label:"Delete",onClick:H(o),color:"inherit",disabled:l})];return O(O([],i?u:s,!0),c,!0)}}],!1)}),[a,n,z,I,q,H]);return{rows:V,rowModesModel:n,columns:ne,handlers:{handleRowEditStop:F,processRowUpdate:K,handleRowModesModelChange:X,handleAddNewRow:J,onProcessRowUpdateError:B,onClose:w,onConfirm:C},apiRef:L,activeRequests:a.length>0,confirmOpen:!!g}}(),l=i.rows,c=i.rowModesModel,u=i.columns,g=i.handlers,w=i.apiRef,C=i.activeRequests,P=i.confirmOpen,j=g.handleAddNewRow,V=g.handleRowEditStop,T=g.handleRowModesModelChange,L=g.processRowUpdate,U=g.onProcessRowUpdateError,Z=g.onClose,q=g.onConfirm;return r.useMemo((function(){return r.createElement(o.A,{sx:G},r.createElement(a.z,{rows:z(z([],n,!0),l,!0),columns:u,editMode:"row",rowModesModel:c,onRowModesModelChange:T,onRowEditStop:V,processRowUpdate:L,onProcessRowUpdateError:U,slots:{toolbar:s},slotProps:{toolbar:{handleAddNewRow:j}},initialState:{pagination:{paginationModel:{pageSize:5}},sorting:{sortModel:[{field:"employeeSigDate",sort:"desc"}]}},sx:{minHeight:450,p:1},apiRef:w,loading:t&&!C,pageSizeOptions:[5,10,25,50,100],autoHeight:!0}),r.createElement(W,{title:"Подтвердите удаление",body:"",open:P,onClose:Z,onConfirm:q()}))}),[n,t,l,c,u,w,j,V,T,L,U,C,Z,q,P])}}}]);
//# sourceMappingURL=469.js.map